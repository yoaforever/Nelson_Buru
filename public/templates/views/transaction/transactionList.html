<div class="page" data-ng-controller="transactionListCtrl as vm">

    <div class="panel panel-default">
        <div class="panel-heading"><strong><span class="glyphicon glyphicon-th"></span> {{vm.title}}</strong></div>
        <div class="panel-body">
            <div data-ng-show="vm.checkedAsBiller" class="row">
                <div class="col-md-12">
                    <!--Filters-->
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <strong>
                                <i class="fa fa-filter"></i> Transactions Filter :
                                <span class="info-blue-custom">{{ vm.billervm.selectedFilter}}</span>
                               
                            </strong>
                        </div>
                        <div class="panel-body">
                            <div class="row">

                                <div class="col-md-6">
                                    <accordion close-others="false" class="ui-accordion ">
                                        <accordion-group heading="Advanced Search +" is-open="true">
                                            <div class="row">


                                                <div class="col-md-4 form-group">
                                                    <div class="label-form">Transaction #.</div>
                                                    <input type="text"
                                                           class="form-control"
                                                           data-ng-model="vm.billervm.filterBy.numberCol"
                                                           placeholder="" />
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="label-form">Related No.</div>
                                                    <input type="text"
                                                           class="form-control"
                                                           data-ng-model="vm.billervm.filterBy.relatedNbrCol"
                                                           placeholder="" />
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="label-form">Payor</div>
                                                    <span class="ui-select">
                                                        <select data-ng-model="vm.billervm.filterBy.payorCol"
                                                                data-ng-options="p.legalName as p.legalName for p in vm.customers">
                                                            <option value="">-- select payor --</option>
                                                        </select>
                                                    </span>
                                                </div>

                                            </div>
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <div class="label-form">Category</div>
                                                    <span class="ui-select">
                                                        <select data-ng-model="vm.billervm.filterBy.categoryCol"
                                                                data-ng-options="c.bizAreaDescription as c.bizAreaDescription for c in vm.categories">
                                                            <option value="">-- all categories --</option>
                                                        </select>
                                                    </span>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="label-form">Type</div>
                                                    <span class="ui-select">
                                                        <select data-ng-model="vm.billervm.filterBy.typeCol"
                                                                data-ng-options="c.description as c.description for c in vm.transactiontypes">
                                                            <option value="">-- all types --</option>
                                                        </select>
                                                        </
                                                    </span>
                                                </div>
                                                <div class="col-md-4">

                                                </div>

                                            </div>
                                            <div class="row">
                                                <div class="col-md-4">
                                                    <div class="label-form">Due date from:</div>
                                                    <div class="input-group ui-datepicker">
                                                        <input type="text"
                                                               show-weeks="false"
                                                               class="form-control"
                                                               datepicker-popup="MM/dd/yyyy"
                                                               data-ng-model="vm.billervm.filterBy.dueDateFromCol"
                                                               is-open="vm.dueDateFromOpened"
                                                               ng-click="vm.open($event,'from')"
                                                               close-text="Close">
                                                        <span class="input-group-addon" ng-click="vm.open($event,'from')"><i class="fa fa-calendar"></i></span>
                                                    </div>
                                                </div>
                                                <div class="col-md-4">
                                                    <div class="label-form">Due date to:</div>
                                                    <div class="input-group ui-datepicker">
                                                        <input type="text"
                                                               show-weeks="false"
                                                               class="form-control"
                                                               datepicker-popup="MM/dd/yyyy"
                                                               data-ng-model="vm.billervm.filterBy.dueDateToCol"
                                                               is-open="vm.dueDateToOpened"
                                                               ng-click="vm.open($event,'to')"
                                                               close-text="Close">
                                                        <span class="input-group-addon" ng-click="vm.open($event,'to')"><i class="fa fa-calendar"></i></span>
                                                    </div>
                                                </div>

                                                <div class="col-md-4">
                                                    <div class="row pull-right">
                                                        <div title="{{vm.billervm.showSeletedBtnTitle}}" data-ng-click="vm.showSelectedTransactions(vm.billervm)" class="btn btn-default"><i data-ng-class="{'fa fa-check-square-o fa-2x':!vm.billervm.showingSeleted,'fa fa-list fa-2x':vm.billervm.showingSeleted}"></i></div>
                                                        <div title="apply filter" data-ng-click="vm.search(vm.billervm, $event)" class="btn btn-default"><i class="fa fa-filter fa-2x "></i></div>
                                                        <div title="clear filter" data-ng-click="vm.clearFilter(vm.billervm)" class="btn btn-default"><i class="fa fa-refresh fa-2x"></i></div>

                                                    </div>
                                                </div>
                                            </div>
                                        </accordion-group>
                                    </accordion>
                                </div>

                                <div class="row col-md-6 form-group">
                                    <div class="col-md-12">
                                        <div class="label-form">switch Biller/Payor</div>
                                        <label class="switch"><input type="checkbox" data-ng-model="vm.checkedAsBiller" ng-change="vm.switchBillerPayor()" checked><i></i></label>
                                        <span class="info-blue-custom">(<span data-ng-show="vm.checkedAsBiller">Biller Mode</span><span data-ng-show="!vm.checkedAsBiller">Payor Mode</span>)</span>
                                    </div>
                                    <div class="row-space-top"></div>
                                    <div class="col-sm-6">
                                        <input type="text"
                                               data-ng-model="vm.billervm.filterBy.allCol"
                                               data-ng-keyup="vm.search(vm.billervm, $event)"
                                               placeholder="quick search"
                                               class="form-control">
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="btn-group">
                                            <button data-ng-show="vm.billervm.filterBy.allCol" data-ng-click="vm.billervm.filterBy.allCol =''" class="btn btn-default" type="button"><i class="fa fa-eraser fa-2x"></i></button>
                                            <button title="apply filter" data-ng-click="vm.search(vm.billervm, $event)" class="btn btn-default"><i class="fa fa-filter fa-2x"></i></button>
                                            <button title="clear filter" data-ng-click="vm.clearFilter(vm.billervm)" class="btn btn-default"><i class="fa fa-refresh fa-2x"></i></button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
                <hr />
                <!-- Transactions Biller Grid -->
                <div class="col-md-12">
                    <section class="table-flip-scroll">
                        <table class="table table-bordered table-striped table-responsive ">

                            <thead class="navbar-inverse">
                                <tr class="th-font">
                                    <th>
                                        <i data-ng-show="!txn.detailsVisbile" class="fa fa-plus-square-o "></i>
                                        <i data-ng-show="txn.detailsVisbile" class="fa fa-minus-square-o "></i>
                                    </th>
                                    <th>
                                        <input type="checkbox" name="billerselectall" data-ng-model="vm.billervm.selectAllTransactions" data-a-ng-click="vm.billerSelectUnSelectAll()">
                                    </th>
                                    <th>Payor</th>
                                    <th>Category</th>
                                    <th>Type</th>
                                    <th>Number</th>
                                    <th>Due Date</th>
                                    <th class="numeric">Amount</th>
                                    <th>Related No.</th>
                                    <th>Status</th>
                                    <th>Payor Ref #</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody data-ng-repeat="txn in vm.billervm.transactions">

                                <tr data-ng-dblclick="vm.toggleDetail(txn)">
                                    <td style="cursor:pointer;" data-ng-click="vm.toggleDetail(txn)">
                                        <i data-ng-show="!txn.detailsVisbile" class="fa fa-plus-square-o "></i>
                                        <i data-ng-show="txn.detailsVisbile" class="fa fa-minus-square-o "></i>
                                    </td>
                                    <td>
                                        <input type="checkbox" name="selected" data-ng-model="txn.selected" data-a-ng-click="vm.billerRefreshTransactionSelection(txn)">
                                    </td>
                                    <td>{{txn.payor_legalName}}</td>
                                    <td>{{txn.bizArea_bizAreaDescription}}</td>
                                    <td>
                                        {{txn.transactionType_description}}
                                        <a data-ng-show="txn.transactionType_id == 1" href="../../documents/bol.pdf" download="{{txn.number}}"><i class="fa fa-floppy-o"></i></a>
                                        <a data-ng-show="txn.transactionType_id == 2" href="../../documents/invoice.pdf" download="{{txn.number}}"><i class="fa fa-floppy-o"></i></a>
                                    </td>
                                    <td>{{txn.number}}</td>
                                    <td>{{txn.dueDate|date:'M/dd/yyyy'}}</td>
                                    <td>{{txn.amount|currency}}</td>
                                    <td>{{txn.relatedNumber}}</td>
                                    <td><span data-ng-class="{badge:true,'badge-success':txn.transactionStatus_id===3,'badge-warning':txn.transactionStatus_id===1,'badge-info':txn.transactionStatus_id===2,'badge-danger':txn.transactionStatus_id===4}">{{txn.transactionStatus_description}}</span></td>
                                    <td>{{txn.payorRefNumber}}</td>
                                    <td>
                                        <div class="btn-group" dropdown is-open="status.isopen1">
                                            <button type="button" class="btn btn-default dropdown-toggle"> Action <span class="caret"></span> </button>
                                            <ul class="dropdown-menu" role="menu">
                                                <li>
                                                    <a data-ng-click="vm.loadAttachment(txn)">
                                                        <i class="doc-attachment-add "></i>
                                                        Add Attachment
                                                    </a>
                                                </li>
                                                <li data-ng-show="txn.transactionStatus_id!=3">
                                                    <a data-ng-click="vm.goToDispute(txn)">
                                                        <i class="fa fa-gavel"></i>
                                                        Dispute
                                                    </a>
                                                </li>
                                                <li data-ng-show="txn.transactionStatus_id!=3">
                                                    <a data-ng-click="vm.goToPayment(txn)">
                                                        <i class="fa fa-credit-card"></i>
                                                        Approve
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>

                                        <ul data-ng-show="txn.attachment.length > 0" class="nav-right pull-right  list-unstyled">
                                            <li class="dropdown">
                                                <a href="javascript:;" class="dropdown-toggle bg-bright" data-toggle="dropdown">
                                                    <i class="fa fa-paperclip fa-2x "></i>
                                                </a>
                                                <div class="dropdown-menu pull-right with-arrow panel panel-default">
                                                    <div class="panel-heading-dark ">
                                                        <span class="th-font">  Transaction #{{txn.number}} have {{txn.attachment.length}} attachment(s)</span>
                                                    </div>
                                                    <ul class="list-group">
                                                        <li class="list-group-item">

                                                            <div class="media-body">
                                                                <section class="table-flip-scroll">
                                                                    <table class="table table-bordered table-striped cf">
                                                                        <thead class="cf">
                                                                            <tr>
                                                                                <th>Attachment Type</th>
                                                                                <th>Description</th>
                                                                                <th>Created Date</th>
                                                                                <th>Viewable to All</th>
                                                                                <th>View</th>
                                                                                <th>Delete</th>
                                                                                <th>Email</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr data-ng-repeat="item in txn.attachment">
                                                                                <td>{{txn.transactionType_description}}{{txn.number}}{{item.fileExtension}}</td>
                                                                                <td>{{item.description}}</td>
                                                                                <td> {{item.createdOn|date:'M/dd/yyyy'}}</td>
                                                                                <td>
                                                                                    <div data-ng-if="item.viewableByOtherParty" style="cursor:pointer">  <i data-a-ng-click="vm.makePrivate(item,txn)" title="public document" class="fa fa-eye fa-2x"></i> </div>
                                                                                    <div data-ng-if="!item.viewableByOtherParty" style="cursor:pointer">  <i data-a-ng-click="vm.makePublic(item,txn)" title="private document" class="fa fa-eye-slash fa-2x"></i> </div>
                                                                                </td>
                                                                                <td>
                                                                                    <div style="cursor:pointer" data-a-ng-click="vm.downloadFile(item,txn)">
                                                                                        <i title="download"
                                                                                           data-ng-class="{'doc-word':(item.fileExtension=='.docx' || item.fileExtension=='.doc' ),
                                                                                                                       'doc-pdf':item.fileExtension=='.pdf' ,
                                                                                                                       'doc-txt':item.fileExtension=='.txt' ,
                                                                                                                       'doc-excel':item.fileExtension=='.xls',
                                                                                                                       'doc-image':(item.fileExtension=='.jpeg' || item.fileExtension=='.jpg' || item.fileExtension=='.png'),
                                                                                                                       'doc-unknown':(item.fileExtension!='.docx' &&
                                                                                                                       item.fileExtension!='.doc' &&
                                                                                                                       item.fileExtension!='.pdf' &&
                                                                                                                       item.fileExtension!='.xls' &&
                                                                                                                       item.fileExtension!='.jpeg' &&
                                                                                                                       item.fileExtension!='.jpg'  &&
                                                                                                                       item.fileExtension!='.png' &&
                                                                                                                       item.fileExtension!='.txt') }"></i>
                                                                                    </div>
                                                                                </td>
                                                                                <td>
                                                                                    <div style="cursor:pointer">  <i data-a-ng-click="vm.removeDocument(item,txn)" title="private document" class="fa fa-trash-o fa-2x"></i> </div>
                                                                                </td>
                                                                                <td>
                                                                                    <div style="cursor:pointer">  <i data-a-ng-click="vm.sendEmail(txn,1)" title="send as email" class="fa fa-envelope fa-2x"></i> </div>
                                                                                </td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                </section>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                    <div class="panel-footer navbar-inverse">
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>

                                        <div data-ng-if="txn.isAttachmentLoad">
                                            <script type="text/ng-template" id="attachment.html">
                                                <div id="myModal" data-ng-controller="attachmentCtrl as vm">
                                                    <div class="modal-header">
                                                        <h3>Upload Attachment for Transaction #{{vm.transaction.number}} <i class="fa fa-paperclip "></i></h3>
                                                    </div>
                                                    <div class="modal-body">
                                                        <progressbar data-ng-show="vm.showLoading" class="progressbar-sm progress-striped active" value="100">{{vm.loadingMsg}}</progressbar>

                                                        <form enctype="multipart/form-data">
                                                            <div class="row">
                                                                <div class="col-md-12">
                                                                    <div class="label-form">Attachment Type</div>
                                                                    <span class="ui-select">
                                                                        <select data-ng-model="vm.selectedattachmenttype"
                                                                                class="input-inline-form"
                                                                                data-ng-options="t.description for t in vm.attachmenttypes">
                                                                            <option value="">-- select attachment type --</option>
                                                                        </select>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-md-12">
                                                                    <div class="label-form">Attachment Description</div>
                                                                    <input type="text"
                                                                           class="form-control"
                                                                           data-ng-model="vm.fileDescription" />
                                                                    <br />
                                                                    <input type="file"
                                                                           title="Choose File"
                                                                           name="Attachment"
                                                                           data-ui-file-upload class="btn-primary"
                                                                           id="{{vm.transaction.id}}Attachmentfile"
                                                                           onchange="angular.element(this).scope().vm.fileNameChaged(this)" />
                                                                    <input data-ng-show="false" name="txnId" value="{{vm.transaction.id}}" type="text" />
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button class="close" data-ng-click="vm.cancel()">Close</button>
                                                    </div>
                                                </div>
                                            </script>


                                        </div>

                                    </td>

                                </tr>
                                <tr data-ng-show="txn.detailsVisbile">
                                    <td colspan="13">
                                        <div data-ng-if="txn.detailsVisbile">
                                            <ng-include src="'/app/views/transaction/transactionTmplt.html'"></ng-include>
                                        </div>
                                    </td>
                                </tr>

                            </tbody>
                        </table>

                        <div class="navbar-inverse ">


                            <div class="totalAmountCss th-font"><b>Total Amount selected : {{vm.billervm.totalSelectedAmount | currency}} </b></div>

                        </div>

                        <footer class="table-footer">
                            <div class="row">
                                <div class="col-md-6 page-num-info">
                                    <div data-ng-show="vm.isLoading" class="col-sm-6"><i class="fa fa-spinner fa-spin fa-2x"></i>Loading ...</div>
                                </div>
                                <div class="col-md-6 text-right pagination-container">
                                    <pagination class="pagination-sm"
                                                ng-model="vm.billervm.paging.currentPage"
                                                total-items="vm.getTxnCount().billerAll"
                                                max-size="2"
                                                ng-change="vm.select(vm.billervm.paging.currentPage,vm.billervm)"
                                                items-per-page="vm.numPerPage"
                                                rotate="false"
                                                boundary-links="true"></pagination>
                                </div>
                            </div>
                        </footer>

                    </section>
                </div>

            </div>

            <div data-ng-show="!vm.checkedAsBiller" class="row">
                <div class="col-md-12">
                    <!--Filters-->
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <strong>
                                <i class="fa fa-filter"></i> Transactions Filter :
                          
                                <span class="info-blue-custom">{{ vm.payorvm.selectedFilter}}</span>
                            </strong>
                        </div>
                        <div class="panel-body">
                            <div class="row">

                                <div class="col-md-6">
                                    <accordion close-others="false" class="ui-accordion ">
                                        <accordion close-others="false" class="ui-accordion ">
                                            <accordion-group heading="Advanced Search +" is-open="true">
                                                <div class="row">


                                                    <div class="col-md-4 form-group">
                                                        <div class="label-form">Transaction #.</div>
                                                        <input type="text"
                                                               class="form-control"
                                                               data-ng-model="vm.payorvm.filterBy.numberCol"
                                                               placeholder="" />
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="label-form">Related No.</div>
                                                        <input type="text"
                                                               class="form-control"
                                                               data-ng-model="vm.payorvm.filterBy.relatedNbrCol"
                                                               placeholder="" />
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="label-form">Biller</div>
                                                        <span class="ui-select">
                                                            <select data-ng-model="vm.payorvm.filterBy.billerCol"
                                                                    data-ng-options="p.legalName as p.legalName for p in vm.customers">
                                                                <option value="">-- select biller --</option>
                                                            </select>
                                                        </span>
                                                    </div>

                                                </div>
                                                <div class="row">
                                                    <div class="col-md-4">
                                                        <div class="label-form">Category</div>
                                                        <span class="ui-select">
                                                            <select data-ng-model="vm.payorvm.filterBy.categoryCol"
                                                                    data-ng-options="c.bizAreaDescription as c.bizAreaDescription for c in vm.categories">
                                                                <option value="">-- all categories --</option>
                                                            </select>
                                                        </span>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="label-form">Type</div>
                                                        <span class="ui-select">
                                                            <select data-ng-model="vm.payorvm.filterBy.typeCol"
                                                                    data-ng-options="c.description as c.description for c in vm.transactiontypes">
                                                                <option value="">-- all types --</option>
                                                            </select>
                                                            </
                                                        </span>
                                                    </div>
                                                    <div class="col-md-4">

                                                    </div>

                                                </div>
                                                <div class="row">
                                                    <div class="col-md-4">
                                                        <div class="label-form">Due date from:</div>
                                                        <div class="input-group ui-datepicker">
                                                            <input type="text"
                                                                   show-weeks="false"
                                                                   class="form-control"
                                                                   datepicker-popup="MM/dd/yyyy"
                                                                   data-ng-model="vm.payorvm.filterBy.dueDateFromCol"
                                                                   is-open="vm.dueDateFrompayorvmOpened"
                                                                   ng-click="vm.open($event,'from')"
                                                                   close-text="Close">
                                                            <span class="input-group-addon" ng-click="vm.open($event,'frompayorvm')"><i class="fa fa-calendar"></i></span>
                                                        </div>
                                                    </div>
                                                    <div class="col-md-4">
                                                        <div class="label-form">Due date to:</div>
                                                        <div class="input-group ui-datepicker">
                                                            <input type="text"
                                                                   show-weeks="false"
                                                                   class="form-control"
                                                                   datepicker-popup="MM/dd/yyyy"
                                                                   data-ng-model="vm.payorvm.filterBy.dueDateToCol"
                                                                   is-open="vm.dueDateTopayorvmOpened"
                                                                   ng-click="vm.open($event,'to')"
                                                                   close-text="Close">
                                                            <span class="input-group-addon" ng-click="vm.open($event,'topayorvm')"><i class="fa fa-calendar"></i></span>
                                                        </div>
                                                    </div>

                                                    <div class="col-md-4">
                                                        <div class="row pull-right">
                                                            <div title="{{vm.payorvm.showSeletedBtnTitle}}" data-ng-click="vm.showSelectedTransactions(vm.payorvm)" class="btn btn-default"><i data-ng-class="{'fa fa-check-square-o fa-2x':!vm.billervm.showingSeleted,'fa fa-list fa-2x':vm.billervm.showingSeleted}"></i></div>
                                                            <div title="apply filter" data-ng-click="vm.search(vm.payorvm, $event)" class="btn btn-default"><i class="fa fa-filter fa-2x "></i></div>
                                                            <div title="clear filter" data-ng-click="vm.clearFilter(vm.payorvm)" class="btn btn-default"><i class="fa fa-refresh fa-2x"></i></div>

                                                        </div>
                                                    </div>
                                                </div>
                                            </accordion-group>
                                        </accordion>
                                    </accordion>
                                </div>

                                <div class="row col-md-6 form-group">
                                    <div class="col-md-12">
                                        <div class="label-form">switch Biller/Payor</div>
                                        <label class="switch"><input type="checkbox" data-ng-model="vm.checkedAsBiller" ng-change="vm.switchBillerPayor()" checked><i></i></label>
                                        <span class="info-blue-custom">(<span data-ng-show="vm.checkedAsBiller">Biller Mode</span><span data-ng-show="!vm.checkedAsBiller">Payor Mode</span>)</span>
                                    </div>
                                    <div class="row-space-top"></div>
                                    <div class="row-space-top"></div>
                                    <div class="col-sm-6">
                                        <input type="text"
                                               data-ng-model="vm.payorvm.filterBy.allCol"
                                               data-ng-keyup="vm.search(vm.payorvm, $event)"
                                               placeholder="quick search"
                                               class="form-control">
                                    </div>
                                    <div class="col-sm-6">
                                        <div class="btn-group">
                                            <button data-ng-show="vm.payorvm.filterBy.allCol" data-ng-click="vm.payorvm.filterBy.allCol =''" class="btn btn-default" type="button"><i class="fa fa-eraser fa-2x"></i></button>
                                            <button title="apply filter" data-ng-click="vm.search(vm.payorvm, $event)" class="btn btn-default"><i class="fa fa-filter fa-2x"></i></button>
                                            <button title="clear filter" data-ng-click="vm.clearFilter(vm.payorvm)" class="btn btn-default"><i class="fa fa-refresh fa-2x"></i></button>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </div>

                </div>
                <hr />
                <!-- Transactions Payor Grid -->
                <div class="col-md-12">
                    <section class="table-flip-scroll">
                        <table class="table table-bordered table-striped table-responsive ">
                            <thead class="navbar-inverse">
                                <tr class="th-font">
                                    <th>
                                        <i data-ng-show="!txn.detailsVisbile" class="fa fa-plus-square-o "></i>
                                        <i data-ng-show="txn.detailsVisbile" class="fa fa-minus-square-o "></i>
                                    </th>
                                    <th>
                                        <input type="checkbox" name="payorselectall" data-ng-model="vm.payorvm.selectAllTransactions" data-a-ng-click="vm.payorSelectUnSelectAll()">
                                    </th>

                                    <th>Biller</th>
                                    <th>Category</th>
                                    <th>Type</th>
                                    <th>Number</th>
                                    <th>Due Date</th>
                                    <th class="numeric">Amount</th>
                                    <th>Related No.</th>
                                    <th>Status</th>
                                    <th>Payor Ref #</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody data-ng-repeat="txn in vm.payorvm.transactions">

                                <tr data-ng-dblclick="vm.toggleDetail(txn)">
                                    <td style="cursor:pointer;" data-ng-click="vm.toggleDetail(txn)">
                                        <i data-ng-show="!txn.detailsVisbile" class="fa fa-plus-square-o "></i>
                                        <i data-ng-show="txn.detailsVisbile" class="fa fa-minus-square-o "></i>
                                    </td>
                                    <td>
                                        <input type="checkbox" name="selected" data-ng-model="txn.selected" data-a-ng-click="vm.payorRefreshTransactionSelection(txn)">
                                    </td>

                                    <td>{{txn.biller_legalName}}</td>
                                    <td>{{txn.bizArea_bizAreaDescription}}</td>
                                    <td>
                                        {{txn.transactionType_description}}
                                        <a data-ng-show="txn.transactionType_id == 1" href="../../documents/bol.pdf" download="{{txn.number}}"><i class="fa fa-floppy-o"></i></a>
                                        <a data-ng-show="txn.transactionType_id == 2" href="../../documents/invoice.pdf" download="{{txn.number}}"><i class="fa fa-floppy-o "></i></a>
                                    </td>
                                    <td>{{txn.number}}</td>
                                    <td>{{txn.dueDate|date:'M/dd/yyyy'}}</td>
                                    <td>{{txn.amount|currency}}</td>
                                    <td>{{txn.relatedNumber}}</td>
                                    <td><span data-ng-class="{badge:true,'badge-success':txn.transactionStatus_id===3,'badge-warning':txn.transactionStatus_id===1,'badge-info':txn.transactionStatus_id===2,'badge-danger':txn.transactionStatus_id===4}">{{txn.transactionStatus_description}}</span></td>
                                    <td>{{txn.payorRefNumber}}</td>
                                    <td>
                                        <div class="btn-group" dropdown is-open="status.isopen1">
                                            <button type="button" class="btn btn-default dropdown-toggle"> Action <span class="caret"></span> </button>
                                            <ul class="dropdown-menu" role="menu">
                                                <li>
                                                    <a data-ng-click="vm.loadAttachment(txn)">
                                                        <i class="doc-attachment-add "></i>
                                                        Add Attachment
                                                    </a>
                                                </li>
                                                <li data-ng-show="txn.transactionStatus_id!=3">
                                                    <a data-ng-click="vm.goToDispute(txn)">
                                                        <i class="fa fa-gavel"></i>
                                                        Dispute
                                                    </a>
                                                </li>
                                                <li data-ng-show="txn.transactionStatus_id!=3">
                                                    <a data-ng-click="vm.goToPayment(txn)">
                                                        <i class="fa fa-credit-card"></i>
                                                        Approve
                                                    </a>
                                                </li>
                                            </ul>
                                        </div>

                                        <ul data-ng-show="txn.attachment.length > 0" class="nav-right pull-right  list-unstyled">
                                            <li class="dropdown">
                                                <a href="javascript:;" class="dropdown-toggle bg-bright" data-toggle="dropdown">
                                                    <i class="fa fa-paperclip fa-2x "></i>
                                                </a>
                                                <div class="dropdown-menu dropdown-attachment pull-right with-arrow panel panel-default">
                                                    <div class="panel-heading-dark ">
                                                        <span class="th-font">  Transaction #{{txn.number}} have {{txn.attachment.length}} attachment(s)</span>
                                                    </div>
                                                    <ul class="list-group">
                                                        <li class="list-group-item">

                                                            <div class="media-body">
                                                                <section class="table-flip-scroll">
                                                                    <table class="table table-bordered table-striped cf">
                                                                        <thead class="cf">
                                                                            <tr>
                                                                                <th>Attachment Type</th>
                                                                                <th>Description</th>
                                                                                <th>Created Date</th>
                                                                                <th>Viewable to All</th>
                                                                                <th>View</th>
                                                                                <th>Delete</th>
                                                                                <th>Email</th>
                                                                            </tr>
                                                                        </thead>
                                                                        <tbody>
                                                                            <tr data-ng-repeat="item in txn.attachment">
                                                                                <td>{{txn.transactionType_description}}{{txn.number}}{{item.fileExtension}}</td>
                                                                                <td>{{item.description}}</td>
                                                                                <td> {{item.createdOn|date:'M/dd/yyyy'}}</td>
                                                                                <td>
                                                                                    <div data-ng-if="item.viewableByOtherParty" style="cursor:pointer">  <i data-a-ng-click="vm.makePrivate(item,txn)" title="public document" class="fa fa-eye fa-2x"></i> </div>
                                                                                    <div data-ng-if="!item.viewableByOtherParty" style="cursor:pointer">  <i data-a-ng-click="vm.makePublic(item,txn)" title="private document" class="fa fa-eye-slash fa-2x"></i> </div>
                                                                                </td>
                                                                                <td>
                                                                                    <div style="cursor:pointer" data-a-ng-click="vm.downloadFile(item,txn)">
                                                                                        <i title="download"
                                                                                           data-ng-class="{'doc-word':(item.fileExtension=='.docx' || item.fileExtension=='.doc' ),
                                                                                                                       'doc-pdf':item.fileExtension=='.pdf' ,
                                                                                                                       'doc-txt':item.fileExtension=='.txt' ,
                                                                                                                       'doc-excel':item.fileExtension=='.xls',
                                                                                                                       'doc-image':(item.fileExtension=='.jpeg' || item.fileExtension=='.jpg' || item.fileExtension=='.png'),
                                                                                                                       'doc-unknown':(item.fileExtension!='.docx' &&
                                                                                                                       item.fileExtension!='.doc' &&
                                                                                                                       item.fileExtension!='.pdf' &&
                                                                                                                       item.fileExtension!='.xls' &&
                                                                                                                       item.fileExtension!='.jpeg' &&
                                                                                                                       item.fileExtension!='.jpg'  &&
                                                                                                                       item.fileExtension!='.png' &&
                                                                                                                       item.fileExtension!='.txt') }"></i>
                                                                                    </div>
                                                                                </td>
                                                                                <td>
                                                                                    <div style="cursor:pointer">  <i data-a-ng-click="vm.removeDocument(item,txn)" title="private document" class="fa fa-trash-o fa-2x"></i> </div>
                                                                                </td>
                                                                                <td>
                                                                                    <div style="cursor:pointer">  <i data-a-ng-click="vm.sendEmail(txn,1)" title="send as email" class="fa fa-envelope fa-2x"></i> </div>
                                                                                </td>
                                                                            </tr>
                                                                        </tbody>
                                                                    </table>
                                                                </section>
                                                            </div>
                                                        </li>
                                                    </ul>
                                                    <div class="panel-footer navbar-inverse">
                                                    </div>
                                                </div>
                                            </li>
                                        </ul>

                                        <div data-ng-if="txn.isAttachmentLoad">

                                            <script type="text/ng-template" id="a.html">
                                                <div data-ng-controller="attachmentCtrl as vm">
                                                    <div class="modal-header">
                                                        <h3>AttHeader  {{vm.transaction.id}}</h3>
                                                    </div>
                                                    <div class="modal-body">
                                                        <form enctype="multipart/form-data">
                                                            <div class="row">
                                                                <div class="col-md-12">
                                                                    <div class="label-form">Attachment Type</div>
                                                                    <span class="ui-select">
                                                                        <select data-ng-model="vm.selectedattachmenttype"
                                                                                class="input-inline-form"
                                                                                data-ng-options="t.description for t in vm.attachmenttypes">
                                                                            <option value="">-- select attachment type --</option>
                                                                        </select>
                                                                    </span>
                                                                </div>
                                                            </div>
                                                            <div class="row">
                                                                <div class="col-md-12">
                                                                    <div class="label-form">Attachment Description</div>
                                                                    <input type="file"
                                                                           title="Choose File"
                                                                           name="Attachment"
                                                                           data-ui-file-upload class="btn-primary"
                                                                           id="{{vm.transaction.id}}Attachmentfile"
                                                                           onchange="angular.element(this).scope().vm.fileNameChaged(this)" />
                                                                    <input data-ng-show="false" name="txnId" value="{{vm.transaction.id}}" type="text" />
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                    <div class="modal-footer">

                                                        <button class="btn btn-warning" ng-click="vm.cancel()">Cancel</button>
                                                    </div>
                                                </div>
                                            </script>


                                        </div>


                                    </td>

                                </tr>
                                <tr data-ng-show="txn.detailsVisbile">
                                    <td colspan="13">
                                        <div data-ng-if="txn.detailsVisbile">
                                            <ng-include src="'/app/views/transaction/transactionTmplt.html'"></ng-include>
                                        </div>
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                        <div class="navbar-inverse ">

                            <div class="totalAmountCss th-font"><b>Total Amount selected : {{vm.payorvm.totalSelectedAmount | currency}} </b></div>





                        </div>

                        <footer class="table-footer">
                            <div class="row">
                                <div class="col-md-6 page-num-info">
                                    <div data-ng-show="vm.isLoading" class="col-sm-6"><i class="fa fa-spinner fa-spin fa-2x"></i>Loading ...</div>

                                </div>
                                <div class="col-md-6 text-right pagination-container">
                                    <pagination class="pagination-sm"
                                                ng-model="vm.payorvm.paging.currentPage"
                                                total-items="vm.getTxnCount().payorAll"
                                                max-size="2"
                                                ng-change="vm.select(vm.payorvm.paging.currentPage,vm.payorvm)"
                                                items-per-page="vm.numPerPage"
                                                rotate="false"
                                                boundary-links="true"></pagination>
                                </div>
                            </div>
                        </footer>

                    </section>
                </div>

            </div>

        </div>


    </div>


</div>
